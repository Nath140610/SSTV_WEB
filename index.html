<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Emmiter SSTV</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main class="app">
    <header class="hero">
      <p class="hero-tag">SSTV MIAMI LINK</p>
      <h1>Emmiter / Recever SSTV</h1>
      <p>Transfert d'image par son entre PC et telephone (SSTV web).</p>
      <div class="hero-stats">
        <span id="emitStageChip" class="chip">Emmiter: idle</span>
        <span id="recvStageChip" class="chip">Recever: idle</span>
      </div>
    </header>

    <section class="role-switch">
      <button id="showEmitter" class="role-btn active" type="button">Mode Emmiter</button>
      <button id="showReceiver" class="role-btn" type="button">Mode Recever</button>
    </section>

    <section id="emitterPanel" class="panel">
      <h2>Emmiter</h2>
      <label class="field">
        <span>Image a emmettre</span>
        <input id="imageInput" type="file" accept="image/*">
      </label>

      <label class="field">
        <span>Qualite</span>
        <select id="qualitySelect">
          <option value="fast">Rapide (24 x 18)</option>
          <option value="normal" selected>Standard (32 x 24)</option>
          <option value="slow">Precise (40 x 30)</option>
        </select>
      </label>

      <label class="field">
        <span>Volume emmeteur: <strong id="emitVolumeLabel">92%</strong></span>
        <input id="emitVolume" type="range" min="20" max="100" step="1" value="92">
      </label>

      <div class="dual-canvas">
        <figure class="canvas-block">
          <figcaption>Image source</figcaption>
          <div class="canvas-wrap">
            <canvas id="previewCanvas" width="320" height="240"></canvas>
          </div>
        </figure>
        <figure class="canvas-block">
          <figcaption>Emission en direct</figcaption>
          <div class="canvas-wrap">
            <canvas id="emitLiveCanvas" width="320" height="240"></canvas>
          </div>
        </figure>
      </div>
      <p id="emitProgress" class="status subtle">Emission: 0% | Image: 0%</p>

      <button id="emitBtn" class="primary" type="button">Emmiter</button>
      <p id="emitStatus" class="status">Choisis une image puis clique sur Emmiter.</p>
    </section>

    <section id="receiverPanel" class="panel hidden">
      <h2>Recever</h2>
      <p class="hint">Apres clic sur Recever: 2 secondes de silence pour calibrer, puis place le micro pres du haut-parleur de l'emmeteur. Si besoin, un mode compatibilite se lance automatiquement.</p>
      <div class="actions">
        <button id="listenBtn" class="primary" type="button">Recever</button>
        <button id="stopBtn" type="button">Stop</button>
      </div>

      <label class="field">
        <span>Sensibilite recever: <strong id="sensitivityLabel">100%</strong></span>
        <input id="sensitivityRange" type="range" min="50" max="250" step="5" value="100">
      </label>
      <div class="sensitivity-modes">
        <button id="sensLowBtn" class="sens-btn" type="button">Pas sensible</button>
        <button id="sensNormalBtn" class="sens-btn active" type="button">Sensible</button>
        <button id="sensExtraBtn" class="sens-btn" type="button">Extra sensible</button>
      </div>

      <div class="scope-wrap">
        <canvas id="audioScope" width="800" height="160"></canvas>
      </div>
      <p id="audioLevel" class="status subtle">Niveau micro: 0%</p>

      <div class="canvas-wrap decode-wrap">
        <canvas id="liveCanvas" width="320" height="240"></canvas>
        <div id="decodeLine" class="decode-line"></div>
      </div>
      <p id="receiveStatus" class="status">En attente du micro.</p>
      <p id="receiveProgress" class="status subtle">Progression: 0%</p>
      <p id="receiveMeta" class="status subtle">Ligne decodee: 0</p>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
